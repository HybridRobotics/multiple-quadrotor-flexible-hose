function[flats] = getUnitvectorsnDerivatives(t,varargin)
% Function to generate Unit vectors and Derivates
% 
% =====================================================================

% Parameters
a = 0; th0 = 0;
b = 0; phi0 = 0; 
if nargin > 1
	phi0 = varargin{1};
end
if nargin > 2
	th0 = varargin{2};
end
if nargin > 3
	a = varargin{3};
end
if nargin > 4
	b = varargin{4};
end



flats.q=[cos(phi0+b.*pi.*t).*cos(a.*pi.*t+th0);cos(phi0+b.*pi.*t).*sin(a.*pi.*t+ ...
  th0);sin(phi0+b.*pi.*t)];


flats.dq(1,1)=(-1).*b.*pi.*cos(a.*pi.*t+th0).*sin(phi0+b.*pi.*t)+(-1).*a.*pi.*cos( ...
  phi0+b.*pi.*t).*sin(a.*pi.*t+th0);
flats.dq(2,1)=a.*pi.*cos(phi0+b.*pi.*t).*cos(a.*pi.*t+th0)+(-1).*b.*pi.*sin(phi0+b.* ...
  pi.*t).*sin(a.*pi.*t+th0);
flats.dq(3,1)=b.*pi.*cos(phi0+b.*pi.*t);


flats.dq(1,2)=(-1).*a.^2.*pi.^2.*cos(phi0+b.*pi.*t).*cos(a.*pi.*t+th0)+(-1).*b.^2.* ...
  pi.^2.*cos(phi0+b.*pi.*t).*cos(a.*pi.*t+th0)+2.*a.*b.*pi.^2.*sin(phi0+ ...
  b.*pi.*t).*sin(a.*pi.*t+th0);
flats.dq(2,2)=(-2).*a.*b.*pi.^2.*cos(a.*pi.*t+th0).*sin(phi0+b.*pi.*t)+(-1).*a.^2.* ...
  pi.^2.*cos(phi0+b.*pi.*t).*sin(a.*pi.*t+th0)+(-1).*b.^2.*pi.^2.*cos( ...
  phi0+b.*pi.*t).*sin(a.*pi.*t+th0);
flats.dq(3,2)=(-1).*b.^2.*pi.^2.*sin(phi0+b.*pi.*t);


flats.dq(1,3)=3.*a.^2.*b.*pi.^3.*cos(a.*pi.*t+th0).*sin(phi0+b.*pi.*t)+b.^3.*pi.^3.* ...
  cos(a.*pi.*t+th0).*sin(phi0+b.*pi.*t)+a.^3.*pi.^3.*cos(phi0+b.*pi.*t).* ...
  sin(a.*pi.*t+th0)+3.*a.*b.^2.*pi.^3.*cos(phi0+b.*pi.*t).*sin(a.*pi.*t+ ...
  th0);
flats.dq(2,3)=(-1).*a.^3.*pi.^3.*cos(phi0+b.*pi.*t).*cos(a.*pi.*t+th0)+(-3).*a.*b.^2.* ...
  pi.^3.*cos(phi0+b.*pi.*t).*cos(a.*pi.*t+th0)+3.*a.^2.*b.*pi.^3.*sin( ...
  phi0+b.*pi.*t).*sin(a.*pi.*t+th0)+b.^3.*pi.^3.*sin(phi0+b.*pi.*t).*sin( ...
  a.*pi.*t+th0);
flats.dq(3,3)=(-1).*b.^3.*pi.^3.*cos(phi0+b.*pi.*t);


flats.dq(1,4)=a.^4.*pi.^4.*cos(phi0+b.*pi.*t).*cos(a.*pi.*t+th0)+6.*a.^2.*b.^2.* ...
  pi.^4.*cos(phi0+b.*pi.*t).*cos(a.*pi.*t+th0)+b.^4.*pi.^4.*cos(phi0+b.* ...
  pi.*t).*cos(a.*pi.*t+th0)+(-4).*a.^3.*b.*pi.^4.*sin(phi0+b.*pi.*t).*sin( ...
  a.*pi.*t+th0)+(-4).*a.*b.^3.*pi.^4.*sin(phi0+b.*pi.*t).*sin(a.*pi.*t+ ...
  th0);
flats.dq(2,4)=4.*a.^3.*b.*pi.^4.*cos(a.*pi.*t+th0).*sin(phi0+b.*pi.*t)+4.*a.*b.^3.* ...
  pi.^4.*cos(a.*pi.*t+th0).*sin(phi0+b.*pi.*t)+a.^4.*pi.^4.*cos(phi0+b.* ...
  pi.*t).*sin(a.*pi.*t+th0)+6.*a.^2.*b.^2.*pi.^4.*cos(phi0+b.*pi.*t).*sin( ...
  a.*pi.*t+th0)+b.^4.*pi.^4.*cos(phi0+b.*pi.*t).*sin(a.*pi.*t+th0);
flats.dq(3,4)=b.^4.*pi.^4.*sin(phi0+b.*pi.*t);


flats.dq(1,5)=(-5).*a.^4.*b.*pi.^5.*cos(a.*pi.*t+th0).*sin(phi0+b.*pi.*t)+(-10).* ...
  a.^2.*b.^3.*pi.^5.*cos(a.*pi.*t+th0).*sin(phi0+b.*pi.*t)+(-1).*b.^5.* ...
  pi.^5.*cos(a.*pi.*t+th0).*sin(phi0+b.*pi.*t)+(-1).*a.^5.*pi.^5.*cos( ...
  phi0+b.*pi.*t).*sin(a.*pi.*t+th0)+(-10).*a.^3.*b.^2.*pi.^5.*cos(phi0+b.* ...
  pi.*t).*sin(a.*pi.*t+th0)+(-5).*a.*b.^4.*pi.^5.*cos(phi0+b.*pi.*t).*sin( ...
  a.*pi.*t+th0);
flats.dq(2,5)=a.^5.*pi.^5.*cos(phi0+b.*pi.*t).*cos(a.*pi.*t+th0)+10.*a.^3.*b.^2.* ...
  pi.^5.*cos(phi0+b.*pi.*t).*cos(a.*pi.*t+th0)+5.*a.*b.^4.*pi.^5.*cos( ...
  phi0+b.*pi.*t).*cos(a.*pi.*t+th0)+(-5).*a.^4.*b.*pi.^5.*sin(phi0+b.*pi.* ...
  t).*sin(a.*pi.*t+th0)+(-10).*a.^2.*b.^3.*pi.^5.*sin(phi0+b.*pi.*t).*sin( ...
  a.*pi.*t+th0)+(-1).*b.^5.*pi.^5.*sin(phi0+b.*pi.*t).*sin(a.*pi.*t+th0); ...
  
flats.dq(3,5)=b.^5.*pi.^5.*cos(phi0+b.*pi.*t);


flats.dq(1,6)=(-1).*a.^6.*pi.^6.*cos(phi0+b.*pi.*t).*cos(a.*pi.*t+th0)+(-15).*a.^4.* ...
  b.^2.*pi.^6.*cos(phi0+b.*pi.*t).*cos(a.*pi.*t+th0)+(-15).*a.^2.*b.^4.* ...
  pi.^6.*cos(phi0+b.*pi.*t).*cos(a.*pi.*t+th0)+(-1).*b.^6.*pi.^6.*cos( ...
  phi0+b.*pi.*t).*cos(a.*pi.*t+th0)+6.*a.^5.*b.*pi.^6.*sin(phi0+b.*pi.*t) ...
  .*sin(a.*pi.*t+th0)+20.*a.^3.*b.^3.*pi.^6.*sin(phi0+b.*pi.*t).*sin(a.* ...
  pi.*t+th0)+6.*a.*b.^5.*pi.^6.*sin(phi0+b.*pi.*t).*sin(a.*pi.*t+th0);
flats.dq(2,6)=(-6).*a.^5.*b.*pi.^6.*cos(a.*pi.*t+th0).*sin(phi0+b.*pi.*t)+(-20).* ...
  a.^3.*b.^3.*pi.^6.*cos(a.*pi.*t+th0).*sin(phi0+b.*pi.*t)+(-6).*a.*b.^5.* ...
  pi.^6.*cos(a.*pi.*t+th0).*sin(phi0+b.*pi.*t)+(-1).*a.^6.*pi.^6.*cos( ...
  phi0+b.*pi.*t).*sin(a.*pi.*t+th0)+(-15).*a.^4.*b.^2.*pi.^6.*cos(phi0+b.* ...
  pi.*t).*sin(a.*pi.*t+th0)+(-15).*a.^2.*b.^4.*pi.^6.*cos(phi0+b.*pi.*t).* ...
  sin(a.*pi.*t+th0)+(-1).*b.^6.*pi.^6.*cos(phi0+b.*pi.*t).*sin(a.*pi.*t+ ...
  th0);
flats.dq(3,6)=(-1).*b.^6.*pi.^6.*sin(phi0+b.*pi.*t);


flats.dq(1,7)=7.*a.^6.*b.*pi.^7.*cos(a.*pi.*t+th0).*sin(phi0+b.*pi.*t)+35.*a.^4.* ...
  b.^3.*pi.^7.*cos(a.*pi.*t+th0).*sin(phi0+b.*pi.*t)+21.*a.^2.*b.^5.* ...
  pi.^7.*cos(a.*pi.*t+th0).*sin(phi0+b.*pi.*t)+b.^7.*pi.^7.*cos(a.*pi.*t+ ...
  th0).*sin(phi0+b.*pi.*t)+a.^7.*pi.^7.*cos(phi0+b.*pi.*t).*sin(a.*pi.*t+ ...
  th0)+21.*a.^5.*b.^2.*pi.^7.*cos(phi0+b.*pi.*t).*sin(a.*pi.*t+th0)+35.* ...
  a.^3.*b.^4.*pi.^7.*cos(phi0+b.*pi.*t).*sin(a.*pi.*t+th0)+7.*a.*b.^6.* ...
  pi.^7.*cos(phi0+b.*pi.*t).*sin(a.*pi.*t+th0);
flats.dq(2,7)=(-1).*a.^7.*pi.^7.*cos(phi0+b.*pi.*t).*cos(a.*pi.*t+th0)+(-21).*a.^5.* ...
  b.^2.*pi.^7.*cos(phi0+b.*pi.*t).*cos(a.*pi.*t+th0)+(-35).*a.^3.*b.^4.* ...
  pi.^7.*cos(phi0+b.*pi.*t).*cos(a.*pi.*t+th0)+(-7).*a.*b.^6.*pi.^7.*cos( ...
  phi0+b.*pi.*t).*cos(a.*pi.*t+th0)+7.*a.^6.*b.*pi.^7.*sin(phi0+b.*pi.*t) ...
  .*sin(a.*pi.*t+th0)+35.*a.^4.*b.^3.*pi.^7.*sin(phi0+b.*pi.*t).*sin(a.* ...
  pi.*t+th0)+21.*a.^2.*b.^5.*pi.^7.*sin(phi0+b.*pi.*t).*sin(a.*pi.*t+th0)+ ...
  b.^7.*pi.^7.*sin(phi0+b.*pi.*t).*sin(a.*pi.*t+th0);
flats.dq(3,7)=(-1).*b.^7.*pi.^7.*cos(phi0+b.*pi.*t);


flats.dq(1,8)=a.^8.*pi.^8.*cos(phi0+b.*pi.*t).*cos(a.*pi.*t+th0)+28.*a.^6.*b.^2.* ...
  pi.^8.*cos(phi0+b.*pi.*t).*cos(a.*pi.*t+th0)+70.*a.^4.*b.^4.*pi.^8.*cos( ...
  phi0+b.*pi.*t).*cos(a.*pi.*t+th0)+28.*a.^2.*b.^6.*pi.^8.*cos(phi0+b.* ...
  pi.*t).*cos(a.*pi.*t+th0)+b.^8.*pi.^8.*cos(phi0+b.*pi.*t).*cos(a.*pi.*t+ ...
  th0)+(-8).*a.^7.*b.*pi.^8.*sin(phi0+b.*pi.*t).*sin(a.*pi.*t+th0)+(-56).* ...
  a.^5.*b.^3.*pi.^8.*sin(phi0+b.*pi.*t).*sin(a.*pi.*t+th0)+(-56).*a.^3.* ...
  b.^5.*pi.^8.*sin(phi0+b.*pi.*t).*sin(a.*pi.*t+th0)+(-8).*a.*b.^7.* ...
  pi.^8.*sin(phi0+b.*pi.*t).*sin(a.*pi.*t+th0);
flats.dq(2,8)=8.*a.^7.*b.*pi.^8.*cos(a.*pi.*t+th0).*sin(phi0+b.*pi.*t)+56.*a.^5.* ...
  b.^3.*pi.^8.*cos(a.*pi.*t+th0).*sin(phi0+b.*pi.*t)+56.*a.^3.*b.^5.* ...
  pi.^8.*cos(a.*pi.*t+th0).*sin(phi0+b.*pi.*t)+8.*a.*b.^7.*pi.^8.*cos(a.* ...
  pi.*t+th0).*sin(phi0+b.*pi.*t)+a.^8.*pi.^8.*cos(phi0+b.*pi.*t).*sin(a.* ...
  pi.*t+th0)+28.*a.^6.*b.^2.*pi.^8.*cos(phi0+b.*pi.*t).*sin(a.*pi.*t+th0)+ ...
  70.*a.^4.*b.^4.*pi.^8.*cos(phi0+b.*pi.*t).*sin(a.*pi.*t+th0)+28.*a.^2.* ...
  b.^6.*pi.^8.*cos(phi0+b.*pi.*t).*sin(a.*pi.*t+th0)+b.^8.*pi.^8.*cos( ...
  phi0+b.*pi.*t).*sin(a.*pi.*t+th0);
flats.dq(3,8)=b.^8.*pi.^8.*sin(phi0+b.*pi.*t);


flats.dq(1,9)=(-9).*a.^8.*b.*pi.^9.*cos(a.*pi.*t+th0).*sin(phi0+b.*pi.*t)+(-84).* ...
  a.^6.*b.^3.*pi.^9.*cos(a.*pi.*t+th0).*sin(phi0+b.*pi.*t)+(-126).*a.^4.* ...
  b.^5.*pi.^9.*cos(a.*pi.*t+th0).*sin(phi0+b.*pi.*t)+(-36).*a.^2.*b.^7.* ...
  pi.^9.*cos(a.*pi.*t+th0).*sin(phi0+b.*pi.*t)+(-1).*b.^9.*pi.^9.*cos(a.* ...
  pi.*t+th0).*sin(phi0+b.*pi.*t)+(-1).*a.^9.*pi.^9.*cos(phi0+b.*pi.*t).* ...
  sin(a.*pi.*t+th0)+(-36).*a.^7.*b.^2.*pi.^9.*cos(phi0+b.*pi.*t).*sin(a.* ...
  pi.*t+th0)+(-126).*a.^5.*b.^4.*pi.^9.*cos(phi0+b.*pi.*t).*sin(a.*pi.*t+ ...
  th0)+(-84).*a.^3.*b.^6.*pi.^9.*cos(phi0+b.*pi.*t).*sin(a.*pi.*t+th0)+( ...
  -9).*a.*b.^8.*pi.^9.*cos(phi0+b.*pi.*t).*sin(a.*pi.*t+th0);
flats.dq(2,9)=a.^9.*pi.^9.*cos(phi0+b.*pi.*t).*cos(a.*pi.*t+th0)+36.*a.^7.*b.^2.* ...
  pi.^9.*cos(phi0+b.*pi.*t).*cos(a.*pi.*t+th0)+126.*a.^5.*b.^4.*pi.^9.* ...
  cos(phi0+b.*pi.*t).*cos(a.*pi.*t+th0)+84.*a.^3.*b.^6.*pi.^9.*cos(phi0+ ...
  b.*pi.*t).*cos(a.*pi.*t+th0)+9.*a.*b.^8.*pi.^9.*cos(phi0+b.*pi.*t).*cos( ...
  a.*pi.*t+th0)+(-9).*a.^8.*b.*pi.^9.*sin(phi0+b.*pi.*t).*sin(a.*pi.*t+ ...
  th0)+(-84).*a.^6.*b.^3.*pi.^9.*sin(phi0+b.*pi.*t).*sin(a.*pi.*t+th0)+( ...
  -126).*a.^4.*b.^5.*pi.^9.*sin(phi0+b.*pi.*t).*sin(a.*pi.*t+th0)+(-36).* ...
  a.^2.*b.^7.*pi.^9.*sin(phi0+b.*pi.*t).*sin(a.*pi.*t+th0)+(-1).*b.^9.* ...
  pi.^9.*sin(phi0+b.*pi.*t).*sin(a.*pi.*t+th0);
flats.dq(3,9)=b.^9.*pi.^9.*cos(phi0+b.*pi.*t);


flats.dq(1,10)=(-1).*a.^10.*pi.^10.*cos(phi0+b.*pi.*t).*cos(a.*pi.*t+th0)+(-45).*a.^8.* ...
  b.^2.*pi.^10.*cos(phi0+b.*pi.*t).*cos(a.*pi.*t+th0)+(-210).*a.^6.*b.^4.* ...
  pi.^10.*cos(phi0+b.*pi.*t).*cos(a.*pi.*t+th0)+(-210).*a.^4.*b.^6.* ...
  pi.^10.*cos(phi0+b.*pi.*t).*cos(a.*pi.*t+th0)+(-45).*a.^2.*b.^8.* ...
  pi.^10.*cos(phi0+b.*pi.*t).*cos(a.*pi.*t+th0)+(-1).*b.^10.*pi.^10.*cos( ...
  phi0+b.*pi.*t).*cos(a.*pi.*t+th0)+10.*a.^9.*b.*pi.^10.*sin(phi0+b.*pi.* ...
  t).*sin(a.*pi.*t+th0)+120.*a.^7.*b.^3.*pi.^10.*sin(phi0+b.*pi.*t).*sin( ...
  a.*pi.*t+th0)+252.*a.^5.*b.^5.*pi.^10.*sin(phi0+b.*pi.*t).*sin(a.*pi.*t+ ...
  th0)+120.*a.^3.*b.^7.*pi.^10.*sin(phi0+b.*pi.*t).*sin(a.*pi.*t+th0)+10.* ...
  a.*b.^9.*pi.^10.*sin(phi0+b.*pi.*t).*sin(a.*pi.*t+th0);
flats.dq(2,10)=(-10).*a.^9.*b.*pi.^10.*cos(a.*pi.*t+th0).*sin(phi0+b.*pi.*t)+(-120).* ...
  a.^7.*b.^3.*pi.^10.*cos(a.*pi.*t+th0).*sin(phi0+b.*pi.*t)+(-252).*a.^5.* ...
  b.^5.*pi.^10.*cos(a.*pi.*t+th0).*sin(phi0+b.*pi.*t)+(-120).*a.^3.*b.^7.* ...
  pi.^10.*cos(a.*pi.*t+th0).*sin(phi0+b.*pi.*t)+(-10).*a.*b.^9.*pi.^10.* ...
  cos(a.*pi.*t+th0).*sin(phi0+b.*pi.*t)+(-1).*a.^10.*pi.^10.*cos(phi0+b.* ...
  pi.*t).*sin(a.*pi.*t+th0)+(-45).*a.^8.*b.^2.*pi.^10.*cos(phi0+b.*pi.*t) ...
  .*sin(a.*pi.*t+th0)+(-210).*a.^6.*b.^4.*pi.^10.*cos(phi0+b.*pi.*t).*sin( ...
  a.*pi.*t+th0)+(-210).*a.^4.*b.^6.*pi.^10.*cos(phi0+b.*pi.*t).*sin(a.* ...
  pi.*t+th0)+(-45).*a.^2.*b.^8.*pi.^10.*cos(phi0+b.*pi.*t).*sin(a.*pi.*t+ ...
  th0)+(-1).*b.^10.*pi.^10.*cos(phi0+b.*pi.*t).*sin(a.*pi.*t+th0);
flats.dq(3,10)=(-1).*b.^10.*pi.^10.*sin(phi0+b.*pi.*t);


flats.dq(1,11)=11.*a.^10.*b.*pi.^11.*cos(a.*pi.*t+th0).*sin(phi0+b.*pi.*t)+165.*a.^8.* ...
  b.^3.*pi.^11.*cos(a.*pi.*t+th0).*sin(phi0+b.*pi.*t)+462.*a.^6.*b.^5.* ...
  pi.^11.*cos(a.*pi.*t+th0).*sin(phi0+b.*pi.*t)+330.*a.^4.*b.^7.*pi.^11.* ...
  cos(a.*pi.*t+th0).*sin(phi0+b.*pi.*t)+55.*a.^2.*b.^9.*pi.^11.*cos(a.* ...
  pi.*t+th0).*sin(phi0+b.*pi.*t)+b.^11.*pi.^11.*cos(a.*pi.*t+th0).*sin( ...
  phi0+b.*pi.*t)+a.^11.*pi.^11.*cos(phi0+b.*pi.*t).*sin(a.*pi.*t+th0)+55.* ...
  a.^9.*b.^2.*pi.^11.*cos(phi0+b.*pi.*t).*sin(a.*pi.*t+th0)+330.*a.^7.* ...
  b.^4.*pi.^11.*cos(phi0+b.*pi.*t).*sin(a.*pi.*t+th0)+462.*a.^5.*b.^6.* ...
  pi.^11.*cos(phi0+b.*pi.*t).*sin(a.*pi.*t+th0)+165.*a.^3.*b.^8.*pi.^11.* ...
  cos(phi0+b.*pi.*t).*sin(a.*pi.*t+th0)+11.*a.*b.^10.*pi.^11.*cos(phi0+b.* ...
  pi.*t).*sin(a.*pi.*t+th0);
flats.dq(2,11)=(-1).*a.^11.*pi.^11.*cos(phi0+b.*pi.*t).*cos(a.*pi.*t+th0)+(-55).*a.^9.* ...
  b.^2.*pi.^11.*cos(phi0+b.*pi.*t).*cos(a.*pi.*t+th0)+(-330).*a.^7.*b.^4.* ...
  pi.^11.*cos(phi0+b.*pi.*t).*cos(a.*pi.*t+th0)+(-462).*a.^5.*b.^6.* ...
  pi.^11.*cos(phi0+b.*pi.*t).*cos(a.*pi.*t+th0)+(-165).*a.^3.*b.^8.* ...
  pi.^11.*cos(phi0+b.*pi.*t).*cos(a.*pi.*t+th0)+(-11).*a.*b.^10.*pi.^11.* ...
  cos(phi0+b.*pi.*t).*cos(a.*pi.*t+th0)+11.*a.^10.*b.*pi.^11.*sin(phi0+b.* ...
  pi.*t).*sin(a.*pi.*t+th0)+165.*a.^8.*b.^3.*pi.^11.*sin(phi0+b.*pi.*t).* ...
  sin(a.*pi.*t+th0)+462.*a.^6.*b.^5.*pi.^11.*sin(phi0+b.*pi.*t).*sin(a.* ...
  pi.*t+th0)+330.*a.^4.*b.^7.*pi.^11.*sin(phi0+b.*pi.*t).*sin(a.*pi.*t+ ...
  th0)+55.*a.^2.*b.^9.*pi.^11.*sin(phi0+b.*pi.*t).*sin(a.*pi.*t+th0)+ ...
  b.^11.*pi.^11.*sin(phi0+b.*pi.*t).*sin(a.*pi.*t+th0);
flats.dq(3,11)=(-1).*b.^11.*pi.^11.*cos(phi0+b.*pi.*t);


flats.dq(1,12)=a.^12.*pi.^12.*cos(phi0+b.*pi.*t).*cos(a.*pi.*t+th0)+66.*a.^10.*b.^2.* ...
  pi.^12.*cos(phi0+b.*pi.*t).*cos(a.*pi.*t+th0)+495.*a.^8.*b.^4.*pi.^12.* ...
  cos(phi0+b.*pi.*t).*cos(a.*pi.*t+th0)+924.*a.^6.*b.^6.*pi.^12.*cos(phi0+ ...
  b.*pi.*t).*cos(a.*pi.*t+th0)+495.*a.^4.*b.^8.*pi.^12.*cos(phi0+b.*pi.*t) ...
  .*cos(a.*pi.*t+th0)+66.*a.^2.*b.^10.*pi.^12.*cos(phi0+b.*pi.*t).*cos(a.* ...
  pi.*t+th0)+b.^12.*pi.^12.*cos(phi0+b.*pi.*t).*cos(a.*pi.*t+th0)+(-12).* ...
  a.^11.*b.*pi.^12.*sin(phi0+b.*pi.*t).*sin(a.*pi.*t+th0)+(-220).*a.^9.* ...
  b.^3.*pi.^12.*sin(phi0+b.*pi.*t).*sin(a.*pi.*t+th0)+(-792).*a.^7.*b.^5.* ...
  pi.^12.*sin(phi0+b.*pi.*t).*sin(a.*pi.*t+th0)+(-792).*a.^5.*b.^7.* ...
  pi.^12.*sin(phi0+b.*pi.*t).*sin(a.*pi.*t+th0)+(-220).*a.^3.*b.^9.* ...
  pi.^12.*sin(phi0+b.*pi.*t).*sin(a.*pi.*t+th0)+(-12).*a.*b.^11.*pi.^12.* ...
  sin(phi0+b.*pi.*t).*sin(a.*pi.*t+th0);
flats.dq(2,12)=12.*a.^11.*b.*pi.^12.*cos(a.*pi.*t+th0).*sin(phi0+b.*pi.*t)+220.*a.^9.* ...
  b.^3.*pi.^12.*cos(a.*pi.*t+th0).*sin(phi0+b.*pi.*t)+792.*a.^7.*b.^5.* ...
  pi.^12.*cos(a.*pi.*t+th0).*sin(phi0+b.*pi.*t)+792.*a.^5.*b.^7.*pi.^12.* ...
  cos(a.*pi.*t+th0).*sin(phi0+b.*pi.*t)+220.*a.^3.*b.^9.*pi.^12.*cos(a.* ...
  pi.*t+th0).*sin(phi0+b.*pi.*t)+12.*a.*b.^11.*pi.^12.*cos(a.*pi.*t+th0).* ...
  sin(phi0+b.*pi.*t)+a.^12.*pi.^12.*cos(phi0+b.*pi.*t).*sin(a.*pi.*t+th0)+ ...
  66.*a.^10.*b.^2.*pi.^12.*cos(phi0+b.*pi.*t).*sin(a.*pi.*t+th0)+495.* ...
  a.^8.*b.^4.*pi.^12.*cos(phi0+b.*pi.*t).*sin(a.*pi.*t+th0)+924.*a.^6.* ...
  b.^6.*pi.^12.*cos(phi0+b.*pi.*t).*sin(a.*pi.*t+th0)+495.*a.^4.*b.^8.* ...
  pi.^12.*cos(phi0+b.*pi.*t).*sin(a.*pi.*t+th0)+66.*a.^2.*b.^10.*pi.^12.* ...
  cos(phi0+b.*pi.*t).*sin(a.*pi.*t+th0)+b.^12.*pi.^12.*cos(phi0+b.*pi.*t) ...
  .*sin(a.*pi.*t+th0);
flats.dq(3,12)=b.^12.*pi.^12.*sin(phi0+b.*pi.*t);


flats.dq(1,13)=(-13).*a.^12.*b.*pi.^13.*cos(a.*pi.*t+th0).*sin(phi0+b.*pi.*t)+(-286).* ...
  a.^10.*b.^3.*pi.^13.*cos(a.*pi.*t+th0).*sin(phi0+b.*pi.*t)+(-1287).* ...
  a.^8.*b.^5.*pi.^13.*cos(a.*pi.*t+th0).*sin(phi0+b.*pi.*t)+(-1716).* ...
  a.^6.*b.^7.*pi.^13.*cos(a.*pi.*t+th0).*sin(phi0+b.*pi.*t)+(-715).*a.^4.* ...
  b.^9.*pi.^13.*cos(a.*pi.*t+th0).*sin(phi0+b.*pi.*t)+(-78).*a.^2.*b.^11.* ...
  pi.^13.*cos(a.*pi.*t+th0).*sin(phi0+b.*pi.*t)+(-1).*b.^13.*pi.^13.*cos( ...
  a.*pi.*t+th0).*sin(phi0+b.*pi.*t)+(-1).*a.^13.*pi.^13.*cos(phi0+b.*pi.* ...
  t).*sin(a.*pi.*t+th0)+(-78).*a.^11.*b.^2.*pi.^13.*cos(phi0+b.*pi.*t).* ...
  sin(a.*pi.*t+th0)+(-715).*a.^9.*b.^4.*pi.^13.*cos(phi0+b.*pi.*t).*sin( ...
  a.*pi.*t+th0)+(-1716).*a.^7.*b.^6.*pi.^13.*cos(phi0+b.*pi.*t).*sin(a.* ...
  pi.*t+th0)+(-1287).*a.^5.*b.^8.*pi.^13.*cos(phi0+b.*pi.*t).*sin(a.*pi.* ...
  t+th0)+(-286).*a.^3.*b.^10.*pi.^13.*cos(phi0+b.*pi.*t).*sin(a.*pi.*t+ ...
  th0)+(-13).*a.*b.^12.*pi.^13.*cos(phi0+b.*pi.*t).*sin(a.*pi.*t+th0);
flats.dq(2,13)=a.^13.*pi.^13.*cos(phi0+b.*pi.*t).*cos(a.*pi.*t+th0)+78.*a.^11.*b.^2.* ...
  pi.^13.*cos(phi0+b.*pi.*t).*cos(a.*pi.*t+th0)+715.*a.^9.*b.^4.*pi.^13.* ...
  cos(phi0+b.*pi.*t).*cos(a.*pi.*t+th0)+1716.*a.^7.*b.^6.*pi.^13.*cos( ...
  phi0+b.*pi.*t).*cos(a.*pi.*t+th0)+1287.*a.^5.*b.^8.*pi.^13.*cos(phi0+b.* ...
  pi.*t).*cos(a.*pi.*t+th0)+286.*a.^3.*b.^10.*pi.^13.*cos(phi0+b.*pi.*t).* ...
  cos(a.*pi.*t+th0)+13.*a.*b.^12.*pi.^13.*cos(phi0+b.*pi.*t).*cos(a.*pi.* ...
  t+th0)+(-13).*a.^12.*b.*pi.^13.*sin(phi0+b.*pi.*t).*sin(a.*pi.*t+th0)+( ...
  -286).*a.^10.*b.^3.*pi.^13.*sin(phi0+b.*pi.*t).*sin(a.*pi.*t+th0)+( ...
  -1287).*a.^8.*b.^5.*pi.^13.*sin(phi0+b.*pi.*t).*sin(a.*pi.*t+th0)+( ...
  -1716).*a.^6.*b.^7.*pi.^13.*sin(phi0+b.*pi.*t).*sin(a.*pi.*t+th0)+(-715) ...
  .*a.^4.*b.^9.*pi.^13.*sin(phi0+b.*pi.*t).*sin(a.*pi.*t+th0)+(-78).* ...
  a.^2.*b.^11.*pi.^13.*sin(phi0+b.*pi.*t).*sin(a.*pi.*t+th0)+(-1).*b.^13.* ...
  pi.^13.*sin(phi0+b.*pi.*t).*sin(a.*pi.*t+th0);
flats.dq(3,13)=b.^13.*pi.^13.*cos(phi0+b.*pi.*t);


flats.dq(1,14)=(-1).*a.^14.*pi.^14.*cos(phi0+b.*pi.*t).*cos(a.*pi.*t+th0)+(-91).* ...
  a.^12.*b.^2.*pi.^14.*cos(phi0+b.*pi.*t).*cos(a.*pi.*t+th0)+(-1001).* ...
  a.^10.*b.^4.*pi.^14.*cos(phi0+b.*pi.*t).*cos(a.*pi.*t+th0)+(-3003).* ...
  a.^8.*b.^6.*pi.^14.*cos(phi0+b.*pi.*t).*cos(a.*pi.*t+th0)+(-3003).* ...
  a.^6.*b.^8.*pi.^14.*cos(phi0+b.*pi.*t).*cos(a.*pi.*t+th0)+(-1001).* ...
  a.^4.*b.^10.*pi.^14.*cos(phi0+b.*pi.*t).*cos(a.*pi.*t+th0)+(-91).*a.^2.* ...
  b.^12.*pi.^14.*cos(phi0+b.*pi.*t).*cos(a.*pi.*t+th0)+(-1).*b.^14.* ...
  pi.^14.*cos(phi0+b.*pi.*t).*cos(a.*pi.*t+th0)+14.*a.^13.*b.*pi.^14.*sin( ...
  phi0+b.*pi.*t).*sin(a.*pi.*t+th0)+364.*a.^11.*b.^3.*pi.^14.*sin(phi0+b.* ...
  pi.*t).*sin(a.*pi.*t+th0)+2002.*a.^9.*b.^5.*pi.^14.*sin(phi0+b.*pi.*t).* ...
  sin(a.*pi.*t+th0)+3432.*a.^7.*b.^7.*pi.^14.*sin(phi0+b.*pi.*t).*sin(a.* ...
  pi.*t+th0)+2002.*a.^5.*b.^9.*pi.^14.*sin(phi0+b.*pi.*t).*sin(a.*pi.*t+ ...
  th0)+364.*a.^3.*b.^11.*pi.^14.*sin(phi0+b.*pi.*t).*sin(a.*pi.*t+th0)+ ...
  14.*a.*b.^13.*pi.^14.*sin(phi0+b.*pi.*t).*sin(a.*pi.*t+th0);
flats.dq(2,14)=(-14).*a.^13.*b.*pi.^14.*cos(a.*pi.*t+th0).*sin(phi0+b.*pi.*t)+(-364).* ...
  a.^11.*b.^3.*pi.^14.*cos(a.*pi.*t+th0).*sin(phi0+b.*pi.*t)+(-2002).* ...
  a.^9.*b.^5.*pi.^14.*cos(a.*pi.*t+th0).*sin(phi0+b.*pi.*t)+(-3432).* ...
  a.^7.*b.^7.*pi.^14.*cos(a.*pi.*t+th0).*sin(phi0+b.*pi.*t)+(-2002).* ...
  a.^5.*b.^9.*pi.^14.*cos(a.*pi.*t+th0).*sin(phi0+b.*pi.*t)+(-364).*a.^3.* ...
  b.^11.*pi.^14.*cos(a.*pi.*t+th0).*sin(phi0+b.*pi.*t)+(-14).*a.*b.^13.* ...
  pi.^14.*cos(a.*pi.*t+th0).*sin(phi0+b.*pi.*t)+(-1).*a.^14.*pi.^14.*cos( ...
  phi0+b.*pi.*t).*sin(a.*pi.*t+th0)+(-91).*a.^12.*b.^2.*pi.^14.*cos(phi0+ ...
  b.*pi.*t).*sin(a.*pi.*t+th0)+(-1001).*a.^10.*b.^4.*pi.^14.*cos(phi0+b.* ...
  pi.*t).*sin(a.*pi.*t+th0)+(-3003).*a.^8.*b.^6.*pi.^14.*cos(phi0+b.*pi.* ...
  t).*sin(a.*pi.*t+th0)+(-3003).*a.^6.*b.^8.*pi.^14.*cos(phi0+b.*pi.*t).* ...
  sin(a.*pi.*t+th0)+(-1001).*a.^4.*b.^10.*pi.^14.*cos(phi0+b.*pi.*t).*sin( ...
  a.*pi.*t+th0)+(-91).*a.^2.*b.^12.*pi.^14.*cos(phi0+b.*pi.*t).*sin(a.* ...
  pi.*t+th0)+(-1).*b.^14.*pi.^14.*cos(phi0+b.*pi.*t).*sin(a.*pi.*t+th0);
flats.dq(3,14)=(-1).*b.^14.*pi.^14.*sin(phi0+b.*pi.*t);


flats.dq(1,15)=15.*a.^14.*b.*pi.^15.*cos(a.*pi.*t+th0).*sin(phi0+b.*pi.*t)+455.*a.^12.* ...
  b.^3.*pi.^15.*cos(a.*pi.*t+th0).*sin(phi0+b.*pi.*t)+3003.*a.^10.*b.^5.* ...
  pi.^15.*cos(a.*pi.*t+th0).*sin(phi0+b.*pi.*t)+6435.*a.^8.*b.^7.*pi.^15.* ...
  cos(a.*pi.*t+th0).*sin(phi0+b.*pi.*t)+5005.*a.^6.*b.^9.*pi.^15.*cos(a.* ...
  pi.*t+th0).*sin(phi0+b.*pi.*t)+1365.*a.^4.*b.^11.*pi.^15.*cos(a.*pi.*t+ ...
  th0).*sin(phi0+b.*pi.*t)+105.*a.^2.*b.^13.*pi.^15.*cos(a.*pi.*t+th0).* ...
  sin(phi0+b.*pi.*t)+b.^15.*pi.^15.*cos(a.*pi.*t+th0).*sin(phi0+b.*pi.*t)+ ...
  a.^15.*pi.^15.*cos(phi0+b.*pi.*t).*sin(a.*pi.*t+th0)+105.*a.^13.*b.^2.* ...
  pi.^15.*cos(phi0+b.*pi.*t).*sin(a.*pi.*t+th0)+1365.*a.^11.*b.^4.* ...
  pi.^15.*cos(phi0+b.*pi.*t).*sin(a.*pi.*t+th0)+5005.*a.^9.*b.^6.*pi.^15.* ...
  cos(phi0+b.*pi.*t).*sin(a.*pi.*t+th0)+6435.*a.^7.*b.^8.*pi.^15.*cos( ...
  phi0+b.*pi.*t).*sin(a.*pi.*t+th0)+3003.*a.^5.*b.^10.*pi.^15.*cos(phi0+ ...
  b.*pi.*t).*sin(a.*pi.*t+th0)+455.*a.^3.*b.^12.*pi.^15.*cos(phi0+b.*pi.* ...
  t).*sin(a.*pi.*t+th0)+15.*a.*b.^14.*pi.^15.*cos(phi0+b.*pi.*t).*sin(a.* ...
  pi.*t+th0);
flats.dq(2,15)=(-1).*a.^15.*pi.^15.*cos(phi0+b.*pi.*t).*cos(a.*pi.*t+th0)+(-105).* ...
  a.^13.*b.^2.*pi.^15.*cos(phi0+b.*pi.*t).*cos(a.*pi.*t+th0)+(-1365).* ...
  a.^11.*b.^4.*pi.^15.*cos(phi0+b.*pi.*t).*cos(a.*pi.*t+th0)+(-5005).* ...
  a.^9.*b.^6.*pi.^15.*cos(phi0+b.*pi.*t).*cos(a.*pi.*t+th0)+(-6435).* ...
  a.^7.*b.^8.*pi.^15.*cos(phi0+b.*pi.*t).*cos(a.*pi.*t+th0)+(-3003).* ...
  a.^5.*b.^10.*pi.^15.*cos(phi0+b.*pi.*t).*cos(a.*pi.*t+th0)+(-455).* ...
  a.^3.*b.^12.*pi.^15.*cos(phi0+b.*pi.*t).*cos(a.*pi.*t+th0)+(-15).*a.* ...
  b.^14.*pi.^15.*cos(phi0+b.*pi.*t).*cos(a.*pi.*t+th0)+15.*a.^14.*b.* ...
  pi.^15.*sin(phi0+b.*pi.*t).*sin(a.*pi.*t+th0)+455.*a.^12.*b.^3.*pi.^15.* ...
  sin(phi0+b.*pi.*t).*sin(a.*pi.*t+th0)+3003.*a.^10.*b.^5.*pi.^15.*sin( ...
  phi0+b.*pi.*t).*sin(a.*pi.*t+th0)+6435.*a.^8.*b.^7.*pi.^15.*sin(phi0+b.* ...
  pi.*t).*sin(a.*pi.*t+th0)+5005.*a.^6.*b.^9.*pi.^15.*sin(phi0+b.*pi.*t).* ...
  sin(a.*pi.*t+th0)+1365.*a.^4.*b.^11.*pi.^15.*sin(phi0+b.*pi.*t).*sin(a.* ...
  pi.*t+th0)+105.*a.^2.*b.^13.*pi.^15.*sin(phi0+b.*pi.*t).*sin(a.*pi.*t+ ...
  th0)+b.^15.*pi.^15.*sin(phi0+b.*pi.*t).*sin(a.*pi.*t+th0);
flats.dq(3,15)=(-1).*b.^15.*pi.^15.*cos(phi0+b.*pi.*t);


flats.dq(1,16)=a.^16.*pi.^16.*cos(phi0+b.*pi.*t).*cos(a.*pi.*t+th0)+120.*a.^14.*b.^2.* ...
  pi.^16.*cos(phi0+b.*pi.*t).*cos(a.*pi.*t+th0)+1820.*a.^12.*b.^4.* ...
  pi.^16.*cos(phi0+b.*pi.*t).*cos(a.*pi.*t+th0)+8008.*a.^10.*b.^6.* ...
  pi.^16.*cos(phi0+b.*pi.*t).*cos(a.*pi.*t+th0)+12870.*a.^8.*b.^8.* ...
  pi.^16.*cos(phi0+b.*pi.*t).*cos(a.*pi.*t+th0)+8008.*a.^6.*b.^10.* ...
  pi.^16.*cos(phi0+b.*pi.*t).*cos(a.*pi.*t+th0)+1820.*a.^4.*b.^12.* ...
  pi.^16.*cos(phi0+b.*pi.*t).*cos(a.*pi.*t+th0)+120.*a.^2.*b.^14.*pi.^16.* ...
  cos(phi0+b.*pi.*t).*cos(a.*pi.*t+th0)+b.^16.*pi.^16.*cos(phi0+b.*pi.*t) ...
  .*cos(a.*pi.*t+th0)+(-16).*a.^15.*b.*pi.^16.*sin(phi0+b.*pi.*t).*sin(a.* ...
  pi.*t+th0)+(-560).*a.^13.*b.^3.*pi.^16.*sin(phi0+b.*pi.*t).*sin(a.*pi.* ...
  t+th0)+(-4368).*a.^11.*b.^5.*pi.^16.*sin(phi0+b.*pi.*t).*sin(a.*pi.*t+ ...
  th0)+(-11440).*a.^9.*b.^7.*pi.^16.*sin(phi0+b.*pi.*t).*sin(a.*pi.*t+th0) ...
  +(-11440).*a.^7.*b.^9.*pi.^16.*sin(phi0+b.*pi.*t).*sin(a.*pi.*t+th0)+( ...
  -4368).*a.^5.*b.^11.*pi.^16.*sin(phi0+b.*pi.*t).*sin(a.*pi.*t+th0)+( ...
  -560).*a.^3.*b.^13.*pi.^16.*sin(phi0+b.*pi.*t).*sin(a.*pi.*t+th0)+(-16) ...
  .*a.*b.^15.*pi.^16.*sin(phi0+b.*pi.*t).*sin(a.*pi.*t+th0);
flats.dq(2,16)=16.*a.^15.*b.*pi.^16.*cos(a.*pi.*t+th0).*sin(phi0+b.*pi.*t)+560.*a.^13.* ...
  b.^3.*pi.^16.*cos(a.*pi.*t+th0).*sin(phi0+b.*pi.*t)+4368.*a.^11.*b.^5.* ...
  pi.^16.*cos(a.*pi.*t+th0).*sin(phi0+b.*pi.*t)+11440.*a.^9.*b.^7.* ...
  pi.^16.*cos(a.*pi.*t+th0).*sin(phi0+b.*pi.*t)+11440.*a.^7.*b.^9.* ...
  pi.^16.*cos(a.*pi.*t+th0).*sin(phi0+b.*pi.*t)+4368.*a.^5.*b.^11.* ...
  pi.^16.*cos(a.*pi.*t+th0).*sin(phi0+b.*pi.*t)+560.*a.^3.*b.^13.*pi.^16.* ...
  cos(a.*pi.*t+th0).*sin(phi0+b.*pi.*t)+16.*a.*b.^15.*pi.^16.*cos(a.*pi.* ...
  t+th0).*sin(phi0+b.*pi.*t)+a.^16.*pi.^16.*cos(phi0+b.*pi.*t).*sin(a.* ...
  pi.*t+th0)+120.*a.^14.*b.^2.*pi.^16.*cos(phi0+b.*pi.*t).*sin(a.*pi.*t+ ...
  th0)+1820.*a.^12.*b.^4.*pi.^16.*cos(phi0+b.*pi.*t).*sin(a.*pi.*t+th0)+ ...
  8008.*a.^10.*b.^6.*pi.^16.*cos(phi0+b.*pi.*t).*sin(a.*pi.*t+th0)+12870.* ...
  a.^8.*b.^8.*pi.^16.*cos(phi0+b.*pi.*t).*sin(a.*pi.*t+th0)+8008.*a.^6.* ...
  b.^10.*pi.^16.*cos(phi0+b.*pi.*t).*sin(a.*pi.*t+th0)+1820.*a.^4.*b.^12.* ...
  pi.^16.*cos(phi0+b.*pi.*t).*sin(a.*pi.*t+th0)+120.*a.^2.*b.^14.*pi.^16.* ...
  cos(phi0+b.*pi.*t).*sin(a.*pi.*t+th0)+b.^16.*pi.^16.*cos(phi0+b.*pi.*t) ...
  .*sin(a.*pi.*t+th0);
flats.dq(3,16)=b.^16.*pi.^16.*sin(phi0+b.*pi.*t);


flats.dq(1,17)=(-17).*a.^16.*b.*pi.^17.*cos(a.*pi.*t+th0).*sin(phi0+b.*pi.*t)+(-680).* ...
  a.^14.*b.^3.*pi.^17.*cos(a.*pi.*t+th0).*sin(phi0+b.*pi.*t)+(-6188).* ...
  a.^12.*b.^5.*pi.^17.*cos(a.*pi.*t+th0).*sin(phi0+b.*pi.*t)+(-19448).* ...
  a.^10.*b.^7.*pi.^17.*cos(a.*pi.*t+th0).*sin(phi0+b.*pi.*t)+(-24310).* ...
  a.^8.*b.^9.*pi.^17.*cos(a.*pi.*t+th0).*sin(phi0+b.*pi.*t)+(-12376).* ...
  a.^6.*b.^11.*pi.^17.*cos(a.*pi.*t+th0).*sin(phi0+b.*pi.*t)+(-2380).* ...
  a.^4.*b.^13.*pi.^17.*cos(a.*pi.*t+th0).*sin(phi0+b.*pi.*t)+(-136).* ...
  a.^2.*b.^15.*pi.^17.*cos(a.*pi.*t+th0).*sin(phi0+b.*pi.*t)+(-1).*b.^17.* ...
  pi.^17.*cos(a.*pi.*t+th0).*sin(phi0+b.*pi.*t)+(-1).*a.^17.*pi.^17.*cos( ...
  phi0+b.*pi.*t).*sin(a.*pi.*t+th0)+(-136).*a.^15.*b.^2.*pi.^17.*cos(phi0+ ...
  b.*pi.*t).*sin(a.*pi.*t+th0)+(-2380).*a.^13.*b.^4.*pi.^17.*cos(phi0+b.* ...
  pi.*t).*sin(a.*pi.*t+th0)+(-12376).*a.^11.*b.^6.*pi.^17.*cos(phi0+b.* ...
  pi.*t).*sin(a.*pi.*t+th0)+(-24310).*a.^9.*b.^8.*pi.^17.*cos(phi0+b.*pi.* ...
  t).*sin(a.*pi.*t+th0)+(-19448).*a.^7.*b.^10.*pi.^17.*cos(phi0+b.*pi.*t) ...
  .*sin(a.*pi.*t+th0)+(-6188).*a.^5.*b.^12.*pi.^17.*cos(phi0+b.*pi.*t).* ...
  sin(a.*pi.*t+th0)+(-680).*a.^3.*b.^14.*pi.^17.*cos(phi0+b.*pi.*t).*sin( ...
  a.*pi.*t+th0)+(-17).*a.*b.^16.*pi.^17.*cos(phi0+b.*pi.*t).*sin(a.*pi.*t+ ...
  th0);
flats.dq(2,17)=a.^17.*pi.^17.*cos(phi0+b.*pi.*t).*cos(a.*pi.*t+th0)+136.*a.^15.*b.^2.* ...
  pi.^17.*cos(phi0+b.*pi.*t).*cos(a.*pi.*t+th0)+2380.*a.^13.*b.^4.* ...
  pi.^17.*cos(phi0+b.*pi.*t).*cos(a.*pi.*t+th0)+12376.*a.^11.*b.^6.* ...
  pi.^17.*cos(phi0+b.*pi.*t).*cos(a.*pi.*t+th0)+24310.*a.^9.*b.^8.* ...
  pi.^17.*cos(phi0+b.*pi.*t).*cos(a.*pi.*t+th0)+19448.*a.^7.*b.^10.* ...
  pi.^17.*cos(phi0+b.*pi.*t).*cos(a.*pi.*t+th0)+6188.*a.^5.*b.^12.* ...
  pi.^17.*cos(phi0+b.*pi.*t).*cos(a.*pi.*t+th0)+680.*a.^3.*b.^14.*pi.^17.* ...
  cos(phi0+b.*pi.*t).*cos(a.*pi.*t+th0)+17.*a.*b.^16.*pi.^17.*cos(phi0+b.* ...
  pi.*t).*cos(a.*pi.*t+th0)+(-17).*a.^16.*b.*pi.^17.*sin(phi0+b.*pi.*t).* ...
  sin(a.*pi.*t+th0)+(-680).*a.^14.*b.^3.*pi.^17.*sin(phi0+b.*pi.*t).*sin( ...
  a.*pi.*t+th0)+(-6188).*a.^12.*b.^5.*pi.^17.*sin(phi0+b.*pi.*t).*sin(a.* ...
  pi.*t+th0)+(-19448).*a.^10.*b.^7.*pi.^17.*sin(phi0+b.*pi.*t).*sin(a.* ...
  pi.*t+th0)+(-24310).*a.^8.*b.^9.*pi.^17.*sin(phi0+b.*pi.*t).*sin(a.*pi.* ...
  t+th0)+(-12376).*a.^6.*b.^11.*pi.^17.*sin(phi0+b.*pi.*t).*sin(a.*pi.*t+ ...
  th0)+(-2380).*a.^4.*b.^13.*pi.^17.*sin(phi0+b.*pi.*t).*sin(a.*pi.*t+th0) ...
  +(-136).*a.^2.*b.^15.*pi.^17.*sin(phi0+b.*pi.*t).*sin(a.*pi.*t+th0)+(-1) ...
  .*b.^17.*pi.^17.*sin(phi0+b.*pi.*t).*sin(a.*pi.*t+th0);
flats.dq(3,17)=b.^17.*pi.^17.*cos(phi0+b.*pi.*t);


flats.dq(1,18)=(-1).*a.^18.*pi.^18.*cos(phi0+b.*pi.*t).*cos(a.*pi.*t+th0)+(-153).* ...
  a.^16.*b.^2.*pi.^18.*cos(phi0+b.*pi.*t).*cos(a.*pi.*t+th0)+(-3060).* ...
  a.^14.*b.^4.*pi.^18.*cos(phi0+b.*pi.*t).*cos(a.*pi.*t+th0)+(-18564).* ...
  a.^12.*b.^6.*pi.^18.*cos(phi0+b.*pi.*t).*cos(a.*pi.*t+th0)+(-43758).* ...
  a.^10.*b.^8.*pi.^18.*cos(phi0+b.*pi.*t).*cos(a.*pi.*t+th0)+(-43758).* ...
  a.^8.*b.^10.*pi.^18.*cos(phi0+b.*pi.*t).*cos(a.*pi.*t+th0)+(-18564).* ...
  a.^6.*b.^12.*pi.^18.*cos(phi0+b.*pi.*t).*cos(a.*pi.*t+th0)+(-3060).* ...
  a.^4.*b.^14.*pi.^18.*cos(phi0+b.*pi.*t).*cos(a.*pi.*t+th0)+(-153).* ...
  a.^2.*b.^16.*pi.^18.*cos(phi0+b.*pi.*t).*cos(a.*pi.*t+th0)+(-1).*b.^18.* ...
  pi.^18.*cos(phi0+b.*pi.*t).*cos(a.*pi.*t+th0)+18.*a.^17.*b.*pi.^18.*sin( ...
  phi0+b.*pi.*t).*sin(a.*pi.*t+th0)+816.*a.^15.*b.^3.*pi.^18.*sin(phi0+b.* ...
  pi.*t).*sin(a.*pi.*t+th0)+8568.*a.^13.*b.^5.*pi.^18.*sin(phi0+b.*pi.*t) ...
  .*sin(a.*pi.*t+th0)+31824.*a.^11.*b.^7.*pi.^18.*sin(phi0+b.*pi.*t).*sin( ...
  a.*pi.*t+th0)+48620.*a.^9.*b.^9.*pi.^18.*sin(phi0+b.*pi.*t).*sin(a.*pi.* ...
  t+th0)+31824.*a.^7.*b.^11.*pi.^18.*sin(phi0+b.*pi.*t).*sin(a.*pi.*t+th0) ...
  +8568.*a.^5.*b.^13.*pi.^18.*sin(phi0+b.*pi.*t).*sin(a.*pi.*t+th0)+816.* ...
  a.^3.*b.^15.*pi.^18.*sin(phi0+b.*pi.*t).*sin(a.*pi.*t+th0)+18.*a.* ...
  b.^17.*pi.^18.*sin(phi0+b.*pi.*t).*sin(a.*pi.*t+th0);
flats.dq(2,18)=(-18).*a.^17.*b.*pi.^18.*cos(a.*pi.*t+th0).*sin(phi0+b.*pi.*t)+(-816).* ...
  a.^15.*b.^3.*pi.^18.*cos(a.*pi.*t+th0).*sin(phi0+b.*pi.*t)+(-8568).* ...
  a.^13.*b.^5.*pi.^18.*cos(a.*pi.*t+th0).*sin(phi0+b.*pi.*t)+(-31824).* ...
  a.^11.*b.^7.*pi.^18.*cos(a.*pi.*t+th0).*sin(phi0+b.*pi.*t)+(-48620).* ...
  a.^9.*b.^9.*pi.^18.*cos(a.*pi.*t+th0).*sin(phi0+b.*pi.*t)+(-31824).* ...
  a.^7.*b.^11.*pi.^18.*cos(a.*pi.*t+th0).*sin(phi0+b.*pi.*t)+(-8568).* ...
  a.^5.*b.^13.*pi.^18.*cos(a.*pi.*t+th0).*sin(phi0+b.*pi.*t)+(-816).* ...
  a.^3.*b.^15.*pi.^18.*cos(a.*pi.*t+th0).*sin(phi0+b.*pi.*t)+(-18).*a.* ...
  b.^17.*pi.^18.*cos(a.*pi.*t+th0).*sin(phi0+b.*pi.*t)+(-1).*a.^18.* ...
  pi.^18.*cos(phi0+b.*pi.*t).*sin(a.*pi.*t+th0)+(-153).*a.^16.*b.^2.* ...
  pi.^18.*cos(phi0+b.*pi.*t).*sin(a.*pi.*t+th0)+(-3060).*a.^14.*b.^4.* ...
  pi.^18.*cos(phi0+b.*pi.*t).*sin(a.*pi.*t+th0)+(-18564).*a.^12.*b.^6.* ...
  pi.^18.*cos(phi0+b.*pi.*t).*sin(a.*pi.*t+th0)+(-43758).*a.^10.*b.^8.* ...
  pi.^18.*cos(phi0+b.*pi.*t).*sin(a.*pi.*t+th0)+(-43758).*a.^8.*b.^10.* ...
  pi.^18.*cos(phi0+b.*pi.*t).*sin(a.*pi.*t+th0)+(-18564).*a.^6.*b.^12.* ...
  pi.^18.*cos(phi0+b.*pi.*t).*sin(a.*pi.*t+th0)+(-3060).*a.^4.*b.^14.* ...
  pi.^18.*cos(phi0+b.*pi.*t).*sin(a.*pi.*t+th0)+(-153).*a.^2.*b.^16.* ...
  pi.^18.*cos(phi0+b.*pi.*t).*sin(a.*pi.*t+th0)+(-1).*b.^18.*pi.^18.*cos( ...
  phi0+b.*pi.*t).*sin(a.*pi.*t+th0);
flats.dq(3,18)=(-1).*b.^18.*pi.^18.*sin(phi0+b.*pi.*t);


flats.dq(1,19)=19.*a.^18.*b.*pi.^19.*cos(a.*pi.*t+th0).*sin(phi0+b.*pi.*t)+969.*a.^16.* ...
  b.^3.*pi.^19.*cos(a.*pi.*t+th0).*sin(phi0+b.*pi.*t)+11628.*a.^14.*b.^5.* ...
  pi.^19.*cos(a.*pi.*t+th0).*sin(phi0+b.*pi.*t)+50388.*a.^12.*b.^7.* ...
  pi.^19.*cos(a.*pi.*t+th0).*sin(phi0+b.*pi.*t)+92378.*a.^10.*b.^9.* ...
  pi.^19.*cos(a.*pi.*t+th0).*sin(phi0+b.*pi.*t)+75582.*a.^8.*b.^11.* ...
  pi.^19.*cos(a.*pi.*t+th0).*sin(phi0+b.*pi.*t)+27132.*a.^6.*b.^13.* ...
  pi.^19.*cos(a.*pi.*t+th0).*sin(phi0+b.*pi.*t)+3876.*a.^4.*b.^15.* ...
  pi.^19.*cos(a.*pi.*t+th0).*sin(phi0+b.*pi.*t)+171.*a.^2.*b.^17.*pi.^19.* ...
  cos(a.*pi.*t+th0).*sin(phi0+b.*pi.*t)+b.^19.*pi.^19.*cos(a.*pi.*t+th0).* ...
  sin(phi0+b.*pi.*t)+a.^19.*pi.^19.*cos(phi0+b.*pi.*t).*sin(a.*pi.*t+th0)+ ...
  171.*a.^17.*b.^2.*pi.^19.*cos(phi0+b.*pi.*t).*sin(a.*pi.*t+th0)+3876.* ...
  a.^15.*b.^4.*pi.^19.*cos(phi0+b.*pi.*t).*sin(a.*pi.*t+th0)+27132.* ...
  a.^13.*b.^6.*pi.^19.*cos(phi0+b.*pi.*t).*sin(a.*pi.*t+th0)+75582.* ...
  a.^11.*b.^8.*pi.^19.*cos(phi0+b.*pi.*t).*sin(a.*pi.*t+th0)+92378.*a.^9.* ...
  b.^10.*pi.^19.*cos(phi0+b.*pi.*t).*sin(a.*pi.*t+th0)+50388.*a.^7.* ...
  b.^12.*pi.^19.*cos(phi0+b.*pi.*t).*sin(a.*pi.*t+th0)+11628.*a.^5.* ...
  b.^14.*pi.^19.*cos(phi0+b.*pi.*t).*sin(a.*pi.*t+th0)+969.*a.^3.*b.^16.* ...
  pi.^19.*cos(phi0+b.*pi.*t).*sin(a.*pi.*t+th0)+19.*a.*b.^18.*pi.^19.*cos( ...
  phi0+b.*pi.*t).*sin(a.*pi.*t+th0);
flats.dq(2,19)=(-1).*a.^19.*pi.^19.*cos(phi0+b.*pi.*t).*cos(a.*pi.*t+th0)+(-171).* ...
  a.^17.*b.^2.*pi.^19.*cos(phi0+b.*pi.*t).*cos(a.*pi.*t+th0)+(-3876).* ...
  a.^15.*b.^4.*pi.^19.*cos(phi0+b.*pi.*t).*cos(a.*pi.*t+th0)+(-27132).* ...
  a.^13.*b.^6.*pi.^19.*cos(phi0+b.*pi.*t).*cos(a.*pi.*t+th0)+(-75582).* ...
  a.^11.*b.^8.*pi.^19.*cos(phi0+b.*pi.*t).*cos(a.*pi.*t+th0)+(-92378).* ...
  a.^9.*b.^10.*pi.^19.*cos(phi0+b.*pi.*t).*cos(a.*pi.*t+th0)+(-50388).* ...
  a.^7.*b.^12.*pi.^19.*cos(phi0+b.*pi.*t).*cos(a.*pi.*t+th0)+(-11628).* ...
  a.^5.*b.^14.*pi.^19.*cos(phi0+b.*pi.*t).*cos(a.*pi.*t+th0)+(-969).* ...
  a.^3.*b.^16.*pi.^19.*cos(phi0+b.*pi.*t).*cos(a.*pi.*t+th0)+(-19).*a.* ...
  b.^18.*pi.^19.*cos(phi0+b.*pi.*t).*cos(a.*pi.*t+th0)+19.*a.^18.*b.* ...
  pi.^19.*sin(phi0+b.*pi.*t).*sin(a.*pi.*t+th0)+969.*a.^16.*b.^3.*pi.^19.* ...
  sin(phi0+b.*pi.*t).*sin(a.*pi.*t+th0)+11628.*a.^14.*b.^5.*pi.^19.*sin( ...
  phi0+b.*pi.*t).*sin(a.*pi.*t+th0)+50388.*a.^12.*b.^7.*pi.^19.*sin(phi0+ ...
  b.*pi.*t).*sin(a.*pi.*t+th0)+92378.*a.^10.*b.^9.*pi.^19.*sin(phi0+b.* ...
  pi.*t).*sin(a.*pi.*t+th0)+75582.*a.^8.*b.^11.*pi.^19.*sin(phi0+b.*pi.*t) ...
  .*sin(a.*pi.*t+th0)+27132.*a.^6.*b.^13.*pi.^19.*sin(phi0+b.*pi.*t).*sin( ...
  a.*pi.*t+th0)+3876.*a.^4.*b.^15.*pi.^19.*sin(phi0+b.*pi.*t).*sin(a.*pi.* ...
  t+th0)+171.*a.^2.*b.^17.*pi.^19.*sin(phi0+b.*pi.*t).*sin(a.*pi.*t+th0)+ ...
  b.^19.*pi.^19.*sin(phi0+b.*pi.*t).*sin(a.*pi.*t+th0);
flats.dq(3,19)=(-1).*b.^19.*pi.^19.*cos(phi0+b.*pi.*t);


flats.dq(1,20)=a.^20.*pi.^20.*cos(phi0+b.*pi.*t).*cos(a.*pi.*t+th0)+190.*a.^18.*b.^2.* ...
  pi.^20.*cos(phi0+b.*pi.*t).*cos(a.*pi.*t+th0)+4845.*a.^16.*b.^4.* ...
  pi.^20.*cos(phi0+b.*pi.*t).*cos(a.*pi.*t+th0)+38760.*a.^14.*b.^6.* ...
  pi.^20.*cos(phi0+b.*pi.*t).*cos(a.*pi.*t+th0)+125970.*a.^12.*b.^8.* ...
  pi.^20.*cos(phi0+b.*pi.*t).*cos(a.*pi.*t+th0)+184756.*a.^10.*b.^10.* ...
  pi.^20.*cos(phi0+b.*pi.*t).*cos(a.*pi.*t+th0)+125970.*a.^8.*b.^12.* ...
  pi.^20.*cos(phi0+b.*pi.*t).*cos(a.*pi.*t+th0)+38760.*a.^6.*b.^14.* ...
  pi.^20.*cos(phi0+b.*pi.*t).*cos(a.*pi.*t+th0)+4845.*a.^4.*b.^16.* ...
  pi.^20.*cos(phi0+b.*pi.*t).*cos(a.*pi.*t+th0)+190.*a.^2.*b.^18.*pi.^20.* ...
  cos(phi0+b.*pi.*t).*cos(a.*pi.*t+th0)+b.^20.*pi.^20.*cos(phi0+b.*pi.*t) ...
  .*cos(a.*pi.*t+th0)+(-20).*a.^19.*b.*pi.^20.*sin(phi0+b.*pi.*t).*sin(a.* ...
  pi.*t+th0)+(-1140).*a.^17.*b.^3.*pi.^20.*sin(phi0+b.*pi.*t).*sin(a.*pi.* ...
  t+th0)+(-15504).*a.^15.*b.^5.*pi.^20.*sin(phi0+b.*pi.*t).*sin(a.*pi.*t+ ...
  th0)+(-77520).*a.^13.*b.^7.*pi.^20.*sin(phi0+b.*pi.*t).*sin(a.*pi.*t+ ...
  th0)+(-167960).*a.^11.*b.^9.*pi.^20.*sin(phi0+b.*pi.*t).*sin(a.*pi.*t+ ...
  th0)+(-167960).*a.^9.*b.^11.*pi.^20.*sin(phi0+b.*pi.*t).*sin(a.*pi.*t+ ...
  th0)+(-77520).*a.^7.*b.^13.*pi.^20.*sin(phi0+b.*pi.*t).*sin(a.*pi.*t+ ...
  th0)+(-15504).*a.^5.*b.^15.*pi.^20.*sin(phi0+b.*pi.*t).*sin(a.*pi.*t+ ...
  th0)+(-1140).*a.^3.*b.^17.*pi.^20.*sin(phi0+b.*pi.*t).*sin(a.*pi.*t+th0) ...
  +(-20).*a.*b.^19.*pi.^20.*sin(phi0+b.*pi.*t).*sin(a.*pi.*t+th0);
flats.dq(2,20)=20.*a.^19.*b.*pi.^20.*cos(a.*pi.*t+th0).*sin(phi0+b.*pi.*t)+1140.* ...
  a.^17.*b.^3.*pi.^20.*cos(a.*pi.*t+th0).*sin(phi0+b.*pi.*t)+15504.* ...
  a.^15.*b.^5.*pi.^20.*cos(a.*pi.*t+th0).*sin(phi0+b.*pi.*t)+77520.* ...
  a.^13.*b.^7.*pi.^20.*cos(a.*pi.*t+th0).*sin(phi0+b.*pi.*t)+167960.* ...
  a.^11.*b.^9.*pi.^20.*cos(a.*pi.*t+th0).*sin(phi0+b.*pi.*t)+167960.* ...
  a.^9.*b.^11.*pi.^20.*cos(a.*pi.*t+th0).*sin(phi0+b.*pi.*t)+77520.*a.^7.* ...
  b.^13.*pi.^20.*cos(a.*pi.*t+th0).*sin(phi0+b.*pi.*t)+15504.*a.^5.* ...
  b.^15.*pi.^20.*cos(a.*pi.*t+th0).*sin(phi0+b.*pi.*t)+1140.*a.^3.*b.^17.* ...
  pi.^20.*cos(a.*pi.*t+th0).*sin(phi0+b.*pi.*t)+20.*a.*b.^19.*pi.^20.*cos( ...
  a.*pi.*t+th0).*sin(phi0+b.*pi.*t)+a.^20.*pi.^20.*cos(phi0+b.*pi.*t).* ...
  sin(a.*pi.*t+th0)+190.*a.^18.*b.^2.*pi.^20.*cos(phi0+b.*pi.*t).*sin(a.* ...
  pi.*t+th0)+4845.*a.^16.*b.^4.*pi.^20.*cos(phi0+b.*pi.*t).*sin(a.*pi.*t+ ...
  th0)+38760.*a.^14.*b.^6.*pi.^20.*cos(phi0+b.*pi.*t).*sin(a.*pi.*t+th0)+ ...
  125970.*a.^12.*b.^8.*pi.^20.*cos(phi0+b.*pi.*t).*sin(a.*pi.*t+th0)+ ...
  184756.*a.^10.*b.^10.*pi.^20.*cos(phi0+b.*pi.*t).*sin(a.*pi.*t+th0)+ ...
  125970.*a.^8.*b.^12.*pi.^20.*cos(phi0+b.*pi.*t).*sin(a.*pi.*t+th0)+ ...
  38760.*a.^6.*b.^14.*pi.^20.*cos(phi0+b.*pi.*t).*sin(a.*pi.*t+th0)+4845.* ...
  a.^4.*b.^16.*pi.^20.*cos(phi0+b.*pi.*t).*sin(a.*pi.*t+th0)+190.*a.^2.* ...
  b.^18.*pi.^20.*cos(phi0+b.*pi.*t).*sin(a.*pi.*t+th0)+b.^20.*pi.^20.*cos( ...
  phi0+b.*pi.*t).*sin(a.*pi.*t+th0);
flats.dq(3,20)=b.^20.*pi.^20.*sin(phi0+b.*pi.*t);


flats.dq(1,21)=(-21).*a.^20.*b.*pi.^21.*cos(a.*pi.*t+th0).*sin(phi0+b.*pi.*t)+(-1330).* ...
  a.^18.*b.^3.*pi.^21.*cos(a.*pi.*t+th0).*sin(phi0+b.*pi.*t)+(-20349).* ...
  a.^16.*b.^5.*pi.^21.*cos(a.*pi.*t+th0).*sin(phi0+b.*pi.*t)+(-116280).* ...
  a.^14.*b.^7.*pi.^21.*cos(a.*pi.*t+th0).*sin(phi0+b.*pi.*t)+(-293930).* ...
  a.^12.*b.^9.*pi.^21.*cos(a.*pi.*t+th0).*sin(phi0+b.*pi.*t)+(-352716).* ...
  a.^10.*b.^11.*pi.^21.*cos(a.*pi.*t+th0).*sin(phi0+b.*pi.*t)+(-203490).* ...
  a.^8.*b.^13.*pi.^21.*cos(a.*pi.*t+th0).*sin(phi0+b.*pi.*t)+(-54264).* ...
  a.^6.*b.^15.*pi.^21.*cos(a.*pi.*t+th0).*sin(phi0+b.*pi.*t)+(-5985).* ...
  a.^4.*b.^17.*pi.^21.*cos(a.*pi.*t+th0).*sin(phi0+b.*pi.*t)+(-210).* ...
  a.^2.*b.^19.*pi.^21.*cos(a.*pi.*t+th0).*sin(phi0+b.*pi.*t)+(-1).*b.^21.* ...
  pi.^21.*cos(a.*pi.*t+th0).*sin(phi0+b.*pi.*t)+(-1).*a.^21.*pi.^21.*cos( ...
  phi0+b.*pi.*t).*sin(a.*pi.*t+th0)+(-210).*a.^19.*b.^2.*pi.^21.*cos(phi0+ ...
  b.*pi.*t).*sin(a.*pi.*t+th0)+(-5985).*a.^17.*b.^4.*pi.^21.*cos(phi0+b.* ...
  pi.*t).*sin(a.*pi.*t+th0)+(-54264).*a.^15.*b.^6.*pi.^21.*cos(phi0+b.* ...
  pi.*t).*sin(a.*pi.*t+th0)+(-203490).*a.^13.*b.^8.*pi.^21.*cos(phi0+b.* ...
  pi.*t).*sin(a.*pi.*t+th0)+(-352716).*a.^11.*b.^10.*pi.^21.*cos(phi0+b.* ...
  pi.*t).*sin(a.*pi.*t+th0)+(-293930).*a.^9.*b.^12.*pi.^21.*cos(phi0+b.* ...
  pi.*t).*sin(a.*pi.*t+th0)+(-116280).*a.^7.*b.^14.*pi.^21.*cos(phi0+b.* ...
  pi.*t).*sin(a.*pi.*t+th0)+(-20349).*a.^5.*b.^16.*pi.^21.*cos(phi0+b.* ...
  pi.*t).*sin(a.*pi.*t+th0)+(-1330).*a.^3.*b.^18.*pi.^21.*cos(phi0+b.*pi.* ...
  t).*sin(a.*pi.*t+th0)+(-21).*a.*b.^20.*pi.^21.*cos(phi0+b.*pi.*t).*sin( ...
  a.*pi.*t+th0);
flats.dq(2,21)=a.^21.*pi.^21.*cos(phi0+b.*pi.*t).*cos(a.*pi.*t+th0)+210.*a.^19.*b.^2.* ...
  pi.^21.*cos(phi0+b.*pi.*t).*cos(a.*pi.*t+th0)+5985.*a.^17.*b.^4.* ...
  pi.^21.*cos(phi0+b.*pi.*t).*cos(a.*pi.*t+th0)+54264.*a.^15.*b.^6.* ...
  pi.^21.*cos(phi0+b.*pi.*t).*cos(a.*pi.*t+th0)+203490.*a.^13.*b.^8.* ...
  pi.^21.*cos(phi0+b.*pi.*t).*cos(a.*pi.*t+th0)+352716.*a.^11.*b.^10.* ...
  pi.^21.*cos(phi0+b.*pi.*t).*cos(a.*pi.*t+th0)+293930.*a.^9.*b.^12.* ...
  pi.^21.*cos(phi0+b.*pi.*t).*cos(a.*pi.*t+th0)+116280.*a.^7.*b.^14.* ...
  pi.^21.*cos(phi0+b.*pi.*t).*cos(a.*pi.*t+th0)+20349.*a.^5.*b.^16.* ...
  pi.^21.*cos(phi0+b.*pi.*t).*cos(a.*pi.*t+th0)+1330.*a.^3.*b.^18.* ...
  pi.^21.*cos(phi0+b.*pi.*t).*cos(a.*pi.*t+th0)+21.*a.*b.^20.*pi.^21.*cos( ...
  phi0+b.*pi.*t).*cos(a.*pi.*t+th0)+(-21).*a.^20.*b.*pi.^21.*sin(phi0+b.* ...
  pi.*t).*sin(a.*pi.*t+th0)+(-1330).*a.^18.*b.^3.*pi.^21.*sin(phi0+b.*pi.* ...
  t).*sin(a.*pi.*t+th0)+(-20349).*a.^16.*b.^5.*pi.^21.*sin(phi0+b.*pi.*t) ...
  .*sin(a.*pi.*t+th0)+(-116280).*a.^14.*b.^7.*pi.^21.*sin(phi0+b.*pi.*t).* ...
  sin(a.*pi.*t+th0)+(-293930).*a.^12.*b.^9.*pi.^21.*sin(phi0+b.*pi.*t).* ...
  sin(a.*pi.*t+th0)+(-352716).*a.^10.*b.^11.*pi.^21.*sin(phi0+b.*pi.*t).* ...
  sin(a.*pi.*t+th0)+(-203490).*a.^8.*b.^13.*pi.^21.*sin(phi0+b.*pi.*t).* ...
  sin(a.*pi.*t+th0)+(-54264).*a.^6.*b.^15.*pi.^21.*sin(phi0+b.*pi.*t).* ...
  sin(a.*pi.*t+th0)+(-5985).*a.^4.*b.^17.*pi.^21.*sin(phi0+b.*pi.*t).*sin( ...
  a.*pi.*t+th0)+(-210).*a.^2.*b.^19.*pi.^21.*sin(phi0+b.*pi.*t).*sin(a.* ...
  pi.*t+th0)+(-1).*b.^21.*pi.^21.*sin(phi0+b.*pi.*t).*sin(a.*pi.*t+th0);
flats.dq(3,21)=b.^21.*pi.^21.*cos(phi0+b.*pi.*t);


flats.dq(1,22)=(-1).*a.^22.*pi.^22.*cos(phi0+b.*pi.*t).*cos(a.*pi.*t+th0)+(-231).* ...
  a.^20.*b.^2.*pi.^22.*cos(phi0+b.*pi.*t).*cos(a.*pi.*t+th0)+(-7315).* ...
  a.^18.*b.^4.*pi.^22.*cos(phi0+b.*pi.*t).*cos(a.*pi.*t+th0)+(-74613).* ...
  a.^16.*b.^6.*pi.^22.*cos(phi0+b.*pi.*t).*cos(a.*pi.*t+th0)+(-319770).* ...
  a.^14.*b.^8.*pi.^22.*cos(phi0+b.*pi.*t).*cos(a.*pi.*t+th0)+(-646646).* ...
  a.^12.*b.^10.*pi.^22.*cos(phi0+b.*pi.*t).*cos(a.*pi.*t+th0)+(-646646).* ...
  a.^10.*b.^12.*pi.^22.*cos(phi0+b.*pi.*t).*cos(a.*pi.*t+th0)+(-319770).* ...
  a.^8.*b.^14.*pi.^22.*cos(phi0+b.*pi.*t).*cos(a.*pi.*t+th0)+(-74613).* ...
  a.^6.*b.^16.*pi.^22.*cos(phi0+b.*pi.*t).*cos(a.*pi.*t+th0)+(-7315).* ...
  a.^4.*b.^18.*pi.^22.*cos(phi0+b.*pi.*t).*cos(a.*pi.*t+th0)+(-231).* ...
  a.^2.*b.^20.*pi.^22.*cos(phi0+b.*pi.*t).*cos(a.*pi.*t+th0)+(-1).*b.^22.* ...
  pi.^22.*cos(phi0+b.*pi.*t).*cos(a.*pi.*t+th0)+22.*a.^21.*b.*pi.^22.*sin( ...
  phi0+b.*pi.*t).*sin(a.*pi.*t+th0)+1540.*a.^19.*b.^3.*pi.^22.*sin(phi0+ ...
  b.*pi.*t).*sin(a.*pi.*t+th0)+26334.*a.^17.*b.^5.*pi.^22.*sin(phi0+b.* ...
  pi.*t).*sin(a.*pi.*t+th0)+170544.*a.^15.*b.^7.*pi.^22.*sin(phi0+b.*pi.* ...
  t).*sin(a.*pi.*t+th0)+497420.*a.^13.*b.^9.*pi.^22.*sin(phi0+b.*pi.*t).* ...
  sin(a.*pi.*t+th0)+705432.*a.^11.*b.^11.*pi.^22.*sin(phi0+b.*pi.*t).*sin( ...
  a.*pi.*t+th0)+497420.*a.^9.*b.^13.*pi.^22.*sin(phi0+b.*pi.*t).*sin(a.* ...
  pi.*t+th0)+170544.*a.^7.*b.^15.*pi.^22.*sin(phi0+b.*pi.*t).*sin(a.*pi.* ...
  t+th0)+26334.*a.^5.*b.^17.*pi.^22.*sin(phi0+b.*pi.*t).*sin(a.*pi.*t+th0) ...
  +1540.*a.^3.*b.^19.*pi.^22.*sin(phi0+b.*pi.*t).*sin(a.*pi.*t+th0)+22.* ...
  a.*b.^21.*pi.^22.*sin(phi0+b.*pi.*t).*sin(a.*pi.*t+th0);
flats.dq(2,22)=(-22).*a.^21.*b.*pi.^22.*cos(a.*pi.*t+th0).*sin(phi0+b.*pi.*t)+(-1540).* ...
  a.^19.*b.^3.*pi.^22.*cos(a.*pi.*t+th0).*sin(phi0+b.*pi.*t)+(-26334).* ...
  a.^17.*b.^5.*pi.^22.*cos(a.*pi.*t+th0).*sin(phi0+b.*pi.*t)+(-170544).* ...
  a.^15.*b.^7.*pi.^22.*cos(a.*pi.*t+th0).*sin(phi0+b.*pi.*t)+(-497420).* ...
  a.^13.*b.^9.*pi.^22.*cos(a.*pi.*t+th0).*sin(phi0+b.*pi.*t)+(-705432).* ...
  a.^11.*b.^11.*pi.^22.*cos(a.*pi.*t+th0).*sin(phi0+b.*pi.*t)+(-497420).* ...
  a.^9.*b.^13.*pi.^22.*cos(a.*pi.*t+th0).*sin(phi0+b.*pi.*t)+(-170544).* ...
  a.^7.*b.^15.*pi.^22.*cos(a.*pi.*t+th0).*sin(phi0+b.*pi.*t)+(-26334).* ...
  a.^5.*b.^17.*pi.^22.*cos(a.*pi.*t+th0).*sin(phi0+b.*pi.*t)+(-1540).* ...
  a.^3.*b.^19.*pi.^22.*cos(a.*pi.*t+th0).*sin(phi0+b.*pi.*t)+(-22).*a.* ...
  b.^21.*pi.^22.*cos(a.*pi.*t+th0).*sin(phi0+b.*pi.*t)+(-1).*a.^22.* ...
  pi.^22.*cos(phi0+b.*pi.*t).*sin(a.*pi.*t+th0)+(-231).*a.^20.*b.^2.* ...
  pi.^22.*cos(phi0+b.*pi.*t).*sin(a.*pi.*t+th0)+(-7315).*a.^18.*b.^4.* ...
  pi.^22.*cos(phi0+b.*pi.*t).*sin(a.*pi.*t+th0)+(-74613).*a.^16.*b.^6.* ...
  pi.^22.*cos(phi0+b.*pi.*t).*sin(a.*pi.*t+th0)+(-319770).*a.^14.*b.^8.* ...
  pi.^22.*cos(phi0+b.*pi.*t).*sin(a.*pi.*t+th0)+(-646646).*a.^12.*b.^10.* ...
  pi.^22.*cos(phi0+b.*pi.*t).*sin(a.*pi.*t+th0)+(-646646).*a.^10.*b.^12.* ...
  pi.^22.*cos(phi0+b.*pi.*t).*sin(a.*pi.*t+th0)+(-319770).*a.^8.*b.^14.* ...
  pi.^22.*cos(phi0+b.*pi.*t).*sin(a.*pi.*t+th0)+(-74613).*a.^6.*b.^16.* ...
  pi.^22.*cos(phi0+b.*pi.*t).*sin(a.*pi.*t+th0)+(-7315).*a.^4.*b.^18.* ...
  pi.^22.*cos(phi0+b.*pi.*t).*sin(a.*pi.*t+th0)+(-231).*a.^2.*b.^20.* ...
  pi.^22.*cos(phi0+b.*pi.*t).*sin(a.*pi.*t+th0)+(-1).*b.^22.*pi.^22.*cos( ...
  phi0+b.*pi.*t).*sin(a.*pi.*t+th0);
flats.dq(3,22)=(-1).*b.^22.*pi.^22.*sin(phi0+b.*pi.*t);


flats.dq(1,23)=23.*a.^22.*b.*pi.^23.*cos(a.*pi.*t+th0).*sin(phi0+b.*pi.*t)+1771.* ...
  a.^20.*b.^3.*pi.^23.*cos(a.*pi.*t+th0).*sin(phi0+b.*pi.*t)+33649.* ...
  a.^18.*b.^5.*pi.^23.*cos(a.*pi.*t+th0).*sin(phi0+b.*pi.*t)+245157.* ...
  a.^16.*b.^7.*pi.^23.*cos(a.*pi.*t+th0).*sin(phi0+b.*pi.*t)+817190.* ...
  a.^14.*b.^9.*pi.^23.*cos(a.*pi.*t+th0).*sin(phi0+b.*pi.*t)+1352078.* ...
  a.^12.*b.^11.*pi.^23.*cos(a.*pi.*t+th0).*sin(phi0+b.*pi.*t)+1144066.* ...
  a.^10.*b.^13.*pi.^23.*cos(a.*pi.*t+th0).*sin(phi0+b.*pi.*t)+490314.* ...
  a.^8.*b.^15.*pi.^23.*cos(a.*pi.*t+th0).*sin(phi0+b.*pi.*t)+100947.* ...
  a.^6.*b.^17.*pi.^23.*cos(a.*pi.*t+th0).*sin(phi0+b.*pi.*t)+8855.*a.^4.* ...
  b.^19.*pi.^23.*cos(a.*pi.*t+th0).*sin(phi0+b.*pi.*t)+253.*a.^2.*b.^21.* ...
  pi.^23.*cos(a.*pi.*t+th0).*sin(phi0+b.*pi.*t)+b.^23.*pi.^23.*cos(a.*pi.* ...
  t+th0).*sin(phi0+b.*pi.*t)+a.^23.*pi.^23.*cos(phi0+b.*pi.*t).*sin(a.* ...
  pi.*t+th0)+253.*a.^21.*b.^2.*pi.^23.*cos(phi0+b.*pi.*t).*sin(a.*pi.*t+ ...
  th0)+8855.*a.^19.*b.^4.*pi.^23.*cos(phi0+b.*pi.*t).*sin(a.*pi.*t+th0)+ ...
  100947.*a.^17.*b.^6.*pi.^23.*cos(phi0+b.*pi.*t).*sin(a.*pi.*t+th0)+ ...
  490314.*a.^15.*b.^8.*pi.^23.*cos(phi0+b.*pi.*t).*sin(a.*pi.*t+th0)+ ...
  1144066.*a.^13.*b.^10.*pi.^23.*cos(phi0+b.*pi.*t).*sin(a.*pi.*t+th0)+ ...
  1352078.*a.^11.*b.^12.*pi.^23.*cos(phi0+b.*pi.*t).*sin(a.*pi.*t+th0)+ ...
  817190.*a.^9.*b.^14.*pi.^23.*cos(phi0+b.*pi.*t).*sin(a.*pi.*t+th0)+ ...
  245157.*a.^7.*b.^16.*pi.^23.*cos(phi0+b.*pi.*t).*sin(a.*pi.*t+th0)+ ...
  33649.*a.^5.*b.^18.*pi.^23.*cos(phi0+b.*pi.*t).*sin(a.*pi.*t+th0)+1771.* ...
  a.^3.*b.^20.*pi.^23.*cos(phi0+b.*pi.*t).*sin(a.*pi.*t+th0)+23.*a.* ...
  b.^22.*pi.^23.*cos(phi0+b.*pi.*t).*sin(a.*pi.*t+th0);
flats.dq(2,23)=(-1).*a.^23.*pi.^23.*cos(phi0+b.*pi.*t).*cos(a.*pi.*t+th0)+(-253).* ...
  a.^21.*b.^2.*pi.^23.*cos(phi0+b.*pi.*t).*cos(a.*pi.*t+th0)+(-8855).* ...
  a.^19.*b.^4.*pi.^23.*cos(phi0+b.*pi.*t).*cos(a.*pi.*t+th0)+(-100947).* ...
  a.^17.*b.^6.*pi.^23.*cos(phi0+b.*pi.*t).*cos(a.*pi.*t+th0)+(-490314).* ...
  a.^15.*b.^8.*pi.^23.*cos(phi0+b.*pi.*t).*cos(a.*pi.*t+th0)+(-1144066).* ...
  a.^13.*b.^10.*pi.^23.*cos(phi0+b.*pi.*t).*cos(a.*pi.*t+th0)+(-1352078).* ...
  a.^11.*b.^12.*pi.^23.*cos(phi0+b.*pi.*t).*cos(a.*pi.*t+th0)+(-817190).* ...
  a.^9.*b.^14.*pi.^23.*cos(phi0+b.*pi.*t).*cos(a.*pi.*t+th0)+(-245157).* ...
  a.^7.*b.^16.*pi.^23.*cos(phi0+b.*pi.*t).*cos(a.*pi.*t+th0)+(-33649).* ...
  a.^5.*b.^18.*pi.^23.*cos(phi0+b.*pi.*t).*cos(a.*pi.*t+th0)+(-1771).* ...
  a.^3.*b.^20.*pi.^23.*cos(phi0+b.*pi.*t).*cos(a.*pi.*t+th0)+(-23).*a.* ...
  b.^22.*pi.^23.*cos(phi0+b.*pi.*t).*cos(a.*pi.*t+th0)+23.*a.^22.*b.* ...
  pi.^23.*sin(phi0+b.*pi.*t).*sin(a.*pi.*t+th0)+1771.*a.^20.*b.^3.* ...
  pi.^23.*sin(phi0+b.*pi.*t).*sin(a.*pi.*t+th0)+33649.*a.^18.*b.^5.* ...
  pi.^23.*sin(phi0+b.*pi.*t).*sin(a.*pi.*t+th0)+245157.*a.^16.*b.^7.* ...
  pi.^23.*sin(phi0+b.*pi.*t).*sin(a.*pi.*t+th0)+817190.*a.^14.*b.^9.* ...
  pi.^23.*sin(phi0+b.*pi.*t).*sin(a.*pi.*t+th0)+1352078.*a.^12.*b.^11.* ...
  pi.^23.*sin(phi0+b.*pi.*t).*sin(a.*pi.*t+th0)+1144066.*a.^10.*b.^13.* ...
  pi.^23.*sin(phi0+b.*pi.*t).*sin(a.*pi.*t+th0)+490314.*a.^8.*b.^15.* ...
  pi.^23.*sin(phi0+b.*pi.*t).*sin(a.*pi.*t+th0)+100947.*a.^6.*b.^17.* ...
  pi.^23.*sin(phi0+b.*pi.*t).*sin(a.*pi.*t+th0)+8855.*a.^4.*b.^19.* ...
  pi.^23.*sin(phi0+b.*pi.*t).*sin(a.*pi.*t+th0)+253.*a.^2.*b.^21.*pi.^23.* ...
  sin(phi0+b.*pi.*t).*sin(a.*pi.*t+th0)+b.^23.*pi.^23.*sin(phi0+b.*pi.*t) ...
  .*sin(a.*pi.*t+th0);
flats.dq(3,23)=(-1).*b.^23.*pi.^23.*cos(phi0+b.*pi.*t);


flats.dq(1,24)=a.^24.*pi.^24.*cos(phi0+b.*pi.*t).*cos(a.*pi.*t+th0)+276.*a.^22.*b.^2.* ...
  pi.^24.*cos(phi0+b.*pi.*t).*cos(a.*pi.*t+th0)+10626.*a.^20.*b.^4.* ...
  pi.^24.*cos(phi0+b.*pi.*t).*cos(a.*pi.*t+th0)+134596.*a.^18.*b.^6.* ...
  pi.^24.*cos(phi0+b.*pi.*t).*cos(a.*pi.*t+th0)+735471.*a.^16.*b.^8.* ...
  pi.^24.*cos(phi0+b.*pi.*t).*cos(a.*pi.*t+th0)+1961256.*a.^14.*b.^10.* ...
  pi.^24.*cos(phi0+b.*pi.*t).*cos(a.*pi.*t+th0)+2704156.*a.^12.*b.^12.* ...
  pi.^24.*cos(phi0+b.*pi.*t).*cos(a.*pi.*t+th0)+1961256.*a.^10.*b.^14.* ...
  pi.^24.*cos(phi0+b.*pi.*t).*cos(a.*pi.*t+th0)+735471.*a.^8.*b.^16.* ...
  pi.^24.*cos(phi0+b.*pi.*t).*cos(a.*pi.*t+th0)+134596.*a.^6.*b.^18.* ...
  pi.^24.*cos(phi0+b.*pi.*t).*cos(a.*pi.*t+th0)+10626.*a.^4.*b.^20.* ...
  pi.^24.*cos(phi0+b.*pi.*t).*cos(a.*pi.*t+th0)+276.*a.^2.*b.^22.*pi.^24.* ...
  cos(phi0+b.*pi.*t).*cos(a.*pi.*t+th0)+b.^24.*pi.^24.*cos(phi0+b.*pi.*t) ...
  .*cos(a.*pi.*t+th0)+(-24).*a.^23.*b.*pi.^24.*sin(phi0+b.*pi.*t).*sin(a.* ...
  pi.*t+th0)+(-2024).*a.^21.*b.^3.*pi.^24.*sin(phi0+b.*pi.*t).*sin(a.*pi.* ...
  t+th0)+(-42504).*a.^19.*b.^5.*pi.^24.*sin(phi0+b.*pi.*t).*sin(a.*pi.*t+ ...
  th0)+(-346104).*a.^17.*b.^7.*pi.^24.*sin(phi0+b.*pi.*t).*sin(a.*pi.*t+ ...
  th0)+(-1307504).*a.^15.*b.^9.*pi.^24.*sin(phi0+b.*pi.*t).*sin(a.*pi.*t+ ...
  th0)+(-2496144).*a.^13.*b.^11.*pi.^24.*sin(phi0+b.*pi.*t).*sin(a.*pi.*t+ ...
  th0)+(-2496144).*a.^11.*b.^13.*pi.^24.*sin(phi0+b.*pi.*t).*sin(a.*pi.*t+ ...
  th0)+(-1307504).*a.^9.*b.^15.*pi.^24.*sin(phi0+b.*pi.*t).*sin(a.*pi.*t+ ...
  th0)+(-346104).*a.^7.*b.^17.*pi.^24.*sin(phi0+b.*pi.*t).*sin(a.*pi.*t+ ...
  th0)+(-42504).*a.^5.*b.^19.*pi.^24.*sin(phi0+b.*pi.*t).*sin(a.*pi.*t+ ...
  th0)+(-2024).*a.^3.*b.^21.*pi.^24.*sin(phi0+b.*pi.*t).*sin(a.*pi.*t+th0) ...
  +(-24).*a.*b.^23.*pi.^24.*sin(phi0+b.*pi.*t).*sin(a.*pi.*t+th0);
flats.dq(2,24)=24.*a.^23.*b.*pi.^24.*cos(a.*pi.*t+th0).*sin(phi0+b.*pi.*t)+2024.* ...
  a.^21.*b.^3.*pi.^24.*cos(a.*pi.*t+th0).*sin(phi0+b.*pi.*t)+42504.* ...
  a.^19.*b.^5.*pi.^24.*cos(a.*pi.*t+th0).*sin(phi0+b.*pi.*t)+346104.* ...
  a.^17.*b.^7.*pi.^24.*cos(a.*pi.*t+th0).*sin(phi0+b.*pi.*t)+1307504.* ...
  a.^15.*b.^9.*pi.^24.*cos(a.*pi.*t+th0).*sin(phi0+b.*pi.*t)+2496144.* ...
  a.^13.*b.^11.*pi.^24.*cos(a.*pi.*t+th0).*sin(phi0+b.*pi.*t)+2496144.* ...
  a.^11.*b.^13.*pi.^24.*cos(a.*pi.*t+th0).*sin(phi0+b.*pi.*t)+1307504.* ...
  a.^9.*b.^15.*pi.^24.*cos(a.*pi.*t+th0).*sin(phi0+b.*pi.*t)+346104.* ...
  a.^7.*b.^17.*pi.^24.*cos(a.*pi.*t+th0).*sin(phi0+b.*pi.*t)+42504.*a.^5.* ...
  b.^19.*pi.^24.*cos(a.*pi.*t+th0).*sin(phi0+b.*pi.*t)+2024.*a.^3.*b.^21.* ...
  pi.^24.*cos(a.*pi.*t+th0).*sin(phi0+b.*pi.*t)+24.*a.*b.^23.*pi.^24.*cos( ...
  a.*pi.*t+th0).*sin(phi0+b.*pi.*t)+a.^24.*pi.^24.*cos(phi0+b.*pi.*t).* ...
  sin(a.*pi.*t+th0)+276.*a.^22.*b.^2.*pi.^24.*cos(phi0+b.*pi.*t).*sin(a.* ...
  pi.*t+th0)+10626.*a.^20.*b.^4.*pi.^24.*cos(phi0+b.*pi.*t).*sin(a.*pi.*t+ ...
  th0)+134596.*a.^18.*b.^6.*pi.^24.*cos(phi0+b.*pi.*t).*sin(a.*pi.*t+th0)+ ...
  735471.*a.^16.*b.^8.*pi.^24.*cos(phi0+b.*pi.*t).*sin(a.*pi.*t+th0)+ ...
  1961256.*a.^14.*b.^10.*pi.^24.*cos(phi0+b.*pi.*t).*sin(a.*pi.*t+th0)+ ...
  2704156.*a.^12.*b.^12.*pi.^24.*cos(phi0+b.*pi.*t).*sin(a.*pi.*t+th0)+ ...
  1961256.*a.^10.*b.^14.*pi.^24.*cos(phi0+b.*pi.*t).*sin(a.*pi.*t+th0)+ ...
  735471.*a.^8.*b.^16.*pi.^24.*cos(phi0+b.*pi.*t).*sin(a.*pi.*t+th0)+ ...
  134596.*a.^6.*b.^18.*pi.^24.*cos(phi0+b.*pi.*t).*sin(a.*pi.*t+th0)+ ...
  10626.*a.^4.*b.^20.*pi.^24.*cos(phi0+b.*pi.*t).*sin(a.*pi.*t+th0)+276.* ...
  a.^2.*b.^22.*pi.^24.*cos(phi0+b.*pi.*t).*sin(a.*pi.*t+th0)+b.^24.* ...
  pi.^24.*cos(phi0+b.*pi.*t).*sin(a.*pi.*t+th0);
flats.dq(3,24)=b.^24.*pi.^24.*sin(phi0+b.*pi.*t);


